<!doctype html>
<html lang="en">

<head>
  <meta charset="utf-8" />
  <title>Smart FAQ — Refined UI</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <!-- Tailwind CDN -->
  <script src="https://cdn.tailwindcss.com"></script>
  <style>
    :root {
      --bg: #EBEBEB;
      --ink: #0b0b0b;
      --radius: 20px;
    }

    html,
    body {
      background: var(--bg);
      color: var(--ink);
    }

    .elev {
      box-shadow: 0 0 0 1px rgba(0, 0, 0, .06), 0 16px 44px rgba(0, 0, 0, .14);
      border-radius: var(--radius);
    }

    .chev {
      transition: transform .25s ease;
    }

    .acc-body {
      grid-template-rows: 0fr;
      transition: grid-template-rows .28s cubic-bezier(.2, .8, .2, 1);
    }

    .acc-open .acc-body {
      grid-template-rows: 1fr;
    }

    .acc-panel {
      min-height: 0;
    }

    .kbd {
      border: 1px solid rgba(0, 0, 0, .18);
      border-radius: 6px;
      padding: .1rem .35rem;
      font-size: .85em;
    }

    .hit mark {
      background: #000;
      color: #fff;
      padding: 0 .2em;
      border-radius: 4px;
    }

    .item {
      border-left: 3px solid transparent;
    }

    .acc-open.item {
      border-left-color: #0b0b0b;
      background: white;
    }

    .eyebrow {
      letter-spacing: .06em;
    }
  </style>
</head>

<body class="antialiased selection:bg-black selection:text-white">

  <main class="max-w-6xl mx-auto px-4 py-12">
    <header class="mb-6">
      <h1 class="text-3xl md:text-4xl font-semibold tracking-tight">Smart FAQ</h1>
      <p class="text-zinc-600">Search, filter, deep link. Press <span class="kbd">/</span> to focus search.</p>
    </header>

    <section class="elev bg-white p-4 md:p-6">
      <!-- Controls -->
      <div class="flex flex-col md:flex-row md:items-center gap-3 md:gap-4">
        <div class="relative flex-1">
          <input id="faq-search" placeholder="Search questions…"
            class="w-full h-11 pl-10 pr-3 rounded-md border border-black/10 focus:ring-2 focus:ring-black/20" />
          <svg class="w-5 h-5 absolute left-3 top-1/2 -translate-y-1/2 text-zinc-500" viewBox="0 0 24 24" fill="none"
            stroke="currentColor">
            <circle cx="11" cy="11" r="7" stroke-width="1.8" />
            <path d="M20 20l-3.2-3.2" stroke-width="1.8" />
          </svg>
        </div>
        <div class="ml-auto flex items-center gap-2">
          <button id="expand-all"
            class="h-10 px-3 rounded-md border border-black/10 hover:bg-black hover:text-white transition">Expand
            all</button>
          <button id="collapse-all"
            class="h-10 px-3 rounded-md border border-black/10 hover:bg-black hover:text-white transition">Collapse
            all</button>
        </div>
      </div>

      <!-- Tag chips -->
      <div id="faq-chips" class="mt-3 flex flex-wrap gap-2"></div>

      <!-- Results count -->
      <div id="faq-count" class="text-sm text-zinc-600 mt-3"></div>

      <!-- Accordion list -->
      <ul id="faq-list" class="mt-4 divide-y divide-black/10"></ul>
    </section>
  </main>

  <script>
    // -----------------------------
    // 1) FAQ DATA (edit freely)
    // -----------------------------
    const FAQ = [
      { id: "quotes-flow", q: "How does the booking/quotation flow work?", a: "You submit your trip details; our team calls to refine the plan; we send a formal quotation with an invoice reference. If you’re in the UAE you can pay via our domestic gateway; otherwise you’ll receive a secure invoice link.", tags: ["Booking", "Quotes"] },
      { id: "tripbuilder-what", q: "What is Trip Builder Lite?", a: "A guided, one-question-at-a-time flow inspired by Typeform. You answer a few curated prompts and get a clear summary plus a stylized boarding-pass preview before submitting.", tags: ["Trip Builder"] },
      { id: "dest-matrix-location", q: "Why do you ask for my location in Destination Matrix?", a: "We use it to pre-select your nearest airport and show accurate flight arcs. If you deny access, you can still choose any origin manually.", tags: ["Destination Matrix", "Privacy"] },
      { id: "invoice-pay", q: "How do I pay an invoice?", a: "Use the Have an Invoice section. Enter your reference to be redirected to the payment page. UAE payments go through our domestic gateway; others may pay via the secure invoice link we issue.", tags: ["Payments", "Invoices"] },
      { id: "invoice-format", q: "What does an invoice reference look like?", a: "References are alphanumeric, 6–24 characters, often prefixed like INV-2025-xxxx or HTL-DEL-xxxx.", tags: ["Invoices"] },
      { id: "refunds", q: "What is your refund policy?", a: "Refunds depend on airline, hotel, and visa partner rules. We’ll outline exact terms on your quotation before you pay. Government fees for visas are usually non-refundable.", tags: ["Refunds", "Policies"] },
      { id: "changes", q: "Can I change dates or traveler names after submitting?", a: "Date changes are usually possible before ticketing; name changes depend on carrier rules. Tell us as soon as possible and we’ll re-quote if needed.", tags: ["Changes"] },
      { id: "visas", q: "Do you help with visas?", a: "Yes. We’ll advise documents at quotation time. Processing times vary by country and season. We don’t guarantee approvals, because embassies don’t either.", tags: ["Visas"] },
      { id: "corporate", q: "Do you handle corporate or group travel?", a: "Yes. We manage luxury groups, negotiated rates, and consolidated invoicing. Share your company details and volume; we’ll set up terms.", tags: ["Corporate"] },
      { id: "hotels-only", q: "Can I book only a hotel if I already have tickets and visa?", a: "Absolutely. Choose Hotels-Only in Trip Builder. We’ll quote properties that match your budget and style.", tags: ["Hotels"] },
      { id: "payments-uae", q: "Is online payment available outside the UAE?", a: "Our primary gateway is UAE-based. If you’re abroad, we’ll generate a secure invoice link or alternate method based on your region.", tags: ["Payments"] },
      { id: "security", q: "How do you secure my data?", a: "We minimize what we collect, use modern encryption in transit, and restrict internal access. You can request deletion of your inquiry anytime.", tags: ["Privacy", "Security"] },
      { id: "support", q: "How do I contact support?", a: "Reply to your quotation email or submit your phone number in the footer rail. We’ll call back during business hours.", tags: ["Support"] },
      { id: "errors", q: "The site looks broken on my phone. Now what?", a: "Try refreshing and ensure low-power mode isn’t throttling animations. If it persists, send a screenshot and device model; we’ll fix it.", tags: ["Tech"] },
    ];

    // -----------------------------
    // 2) Elements and state
    // -----------------------------
    const listEl = document.getElementById("faq-list");
    const countEl = document.getElementById("faq-count");
    const chipsEl = document.getElementById("faq-chips");
    const searchEl = document.getElementById("faq-search");

    const TAGS = Array.from(new Set(FAQ.flatMap(f => f.tags))).sort();
    let activeTags = new Set();
    let query = "";

    // -----------------------------
    // 3) Build tag chips
    // -----------------------------
    TAGS.forEach(tag => {
      const b = document.createElement("button");
      b.type = "button";
      b.textContent = tag;
      b.className = "h-9 px-3 rounded-full border border-black/10 hover:bg-black hover:text-white transition text-sm";
      b.addEventListener("click", () => {
        b.classList.toggle("bg-black");
        b.classList.toggle("text-white");
        if (activeTags.has(tag)) activeTags.delete(tag); else activeTags.add(tag);
        render();
      });
      chipsEl.appendChild(b);
    });

    // Search behavior and keyboard shortcut
    searchEl.addEventListener("input", () => { query = searchEl.value.trim().toLowerCase(); render(); });
    document.addEventListener("keydown", e => {
      if (e.key === "/" && document.activeElement !== searchEl) { e.preventDefault(); searchEl.focus(); }
    });

    document.getElementById("expand-all").addEventListener("click", () => {
      listEl.querySelectorAll("li").forEach(li => { if (!li.classList.contains("acc-open")) li.querySelector("button")?.click(); });
    });
    document.getElementById("collapse-all").addEventListener("click", () => {
      listEl.querySelectorAll("li.acc-open").forEach(li => li.querySelector("button")?.click());
    });

    // -----------------------------
    // 4) Render
    // -----------------------------
    function render() {
      listEl.innerHTML = "";
      const results = FAQ.filter(item => {
        const tagPass = activeTags.size ? item.tags.some(t => activeTags.has(t)) : true;
        const text = (item.q + " " + item.a).toLowerCase();
        const qPass = query ? text.includes(query) : true;
        return tagPass && qPass;
      });

      countEl.textContent = `${results.length} result${results.length !== 1 ? "s" : ""}`;

      results.forEach(item => {
        const li = document.createElement("li");
        li.id = item.id;
        li.className = "item py-3 px-2 md:px-3 transition-colors";

        // Snippet: first sentence, trimmed
        const firstSentence = item.a.split(/(?<=\.)\s/)[0] || item.a;
        const snippet = truncate(firstSentence, 140);

        const hitQ = highlight(item.q, query);
        const hitS = highlight(snippet, query);
        const hitA = highlight(item.a, query);

        li.innerHTML = `
          <button class="w-full text-left flex items-start justify-between gap-3 group" aria-expanded="false" aria-controls="${item.id}-panel">
            <div class="flex-1">
              <div class="flex items-center gap-3">
                <span class="eyebrow text-[11px] uppercase text-zinc-500">${item.tags[0] || "General"}</span>
                <span class="hidden md:inline text-[11px] text-zinc-400">•</span>
                <span class="hidden md:inline text-[11px] text-zinc-500">${item.tags.slice(1).join(" / ")}</span>
              </div>
              <h2 class="mt-1 text-lg md:text-xl font-semibold tracking-tight group-hover:underline ${query ? "hit" : ""}">${hitQ}</h2>
              <p class="text-sm md:text-[15px] text-zinc-600 mt-1 line-clamp-2" data-snippet>${hitS}</p>

              <div id="${item.id}-panel" class="grid acc-body mt-1">
                <div class="acc-panel overflow-hidden">
                  <div class="pt-3">
                    <div class="max-w-prose leading-7 text-[15px] text-zinc-700 ${query ? "hit" : ""}">${hitA}</div>
                    <div class="mt-3 flex flex-wrap items-center gap-2">
                      ${item.tags.map(t => `<span class="inline-block px-2 py-0.5 border rounded-full text-zinc-600 border-black/10 text-xs">${t}</span>`).join("")}
                    </div>
                  </div>
                </div>
              </div>
            </div>
            <svg class="chev w-5 h-5 mt-1 text-zinc-600 shrink-0" viewBox="0 0 24 24" fill="none" stroke="currentColor">
              <path d="M6 9l6 6 6-6" stroke-width="1.8"/>
            </svg>
          </button>
        `;

        const btn = li.querySelector("button");
        const chevron = li.querySelector(".chev");
        const snippetEl = li.querySelector("[data-snippet]");

        btn.addEventListener("click", () => {
          const open = li.classList.toggle("acc-open");
          btn.setAttribute("aria-expanded", String(open));
          chevron.style.transform = open ? "rotate(180deg)" : "rotate(0deg)";
          // hide snippet when open, show when closed
          snippetEl.style.display = open ? "none" : "";
        });

        listEl.appendChild(li);
      });

      // Open matching hash on initial render
      if (location.hash) {
        const target = document.querySelector(location.hash);
        if (target && listEl.contains(target)) {
          const btn = target.querySelector("button");
          btn?.click();
          target.scrollIntoView({ behavior: "smooth", block: "start" });
        }
      }
    }

    // Helpers
    function truncate(s, n) { return s.length > n ? s.slice(0, n - 1).trimEnd() + "…" : s; }
    function highlight(text, q) {
      if (!q) return esc(text);
      const ix = text.toLowerCase().indexOf(q);
      if (ix < 0) return esc(text);
      const before = esc(text.slice(0, ix));
      const mid = esc(text.slice(ix, ix + q.length));
      const after = esc(text.slice(ix + q.length));
      return `${before}<mark>${mid}</mark>${after}`;
    }
    function esc(s) { return s.replace(/[&<>"']/g, m => ({ "&": "&amp;", "<": "&lt;", ">": "&gt;", '"': "&quot;", "'": "&#39;" }[m])); }

    // Respect hash navigation changes too
    window.addEventListener("hashchange", () => render());

    // Initial render
    render();
  </script>
</body>

</html>